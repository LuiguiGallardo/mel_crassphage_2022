strip.text.x = element_text(size = 6))
boxplot_median
require("gridExtra")
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library("optparse")
library("ggplot2")
library("reshape")
require("gridExtra")
library("ggpubr")
library("ggh4x")
library("dplyr")
library("rstatix")
# Data input
table <- read.table(file = "./probiotics_03082022.txt",
sep = "\t",
header = TRUE,
check.names = FALSE)
View(table)
table <- melt(table,
id.vars=c("sample", "Tissue", "Condition"))
# boxplot
theme_set(theme_bw())
boxplot <- ggplot(data = table,
aes(y = value,
x = group,
color = group)) +
geom_boxplot(aes(color = group)) +
geom_point(aes(color = group),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_wrap(Tissue ~ variable) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = value,
x = Tissue,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = group),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_wrap(Tissue ~ variable) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = value,
x = Tissue,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Tissue),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_wrap(Tissue ~ variable) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = value,
x = Tissue,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Tissue),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_wrap(Tissue ~ Condition) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = value,
x = Tissue,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Condition),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_wrap(Tissue ~ Condition) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = value,
x = Tissue,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Condition),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_wrap(Tissue ~ Variable) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = value,
x = Tissue,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Condition),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_wrap(Tissue ~ variable) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = value,
x = Tissue,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Condition),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_grid(Tissue ~ variable) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = value,
x = Tissue,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Condition),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_grid(Condition ~ variable) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = value,
x = Tissue,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Condition),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_grid(variable~Condition) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = value,
x = variable,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Condition),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_grid(Tissue~Condition) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = value,
x = variable,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Tissue),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_grid(Tissue~Condition) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
table$log10 <- log(table$variable)
table$log10 <- log(table$value)
boxplot <- ggplot(data = table,
aes(y = value,
x = log10,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Tissue),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_grid(Tissue~Condition) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = log10,
x = variable,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Tissue),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_grid(Tissue~Condition) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = log10,
x = variable,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Tissue),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_grid(Condition~Tissue) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = log10,
x = variable,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Tissue),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_grid(~Condition) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = log10,
x = variable,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Tissue),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_grid(Condition~Tissue) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance",
title="Host crassphage") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
boxplot <- ggplot(data = table,
aes(y = log10,
x = variable,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Tissue),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_grid(Condition~Tissue) +
#  stat_compare_means(comparisons = p_value,
#                     method = "wilcox.test") +
labs(x="",
y="Relative abundance (log10)",
title="Probiotics Penaeus Monodon") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
# Data input
table <- read.table(file = "./probiotics_03082022.txt",
sep = "\t",
header = TRUE,
check.names = FALSE)
table <- melt(table,
id.vars=c("sample", "Tissue", "Condition"))
table$log10 <- log(table$value)
# boxplot log10
theme_set(theme_bw())
boxplot <- ggplot(data = table,
aes(y = value,
x = variable,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Tissue),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_grid(Condition~Tissue) +
labs(x="",
y="Relative abundance",
title="Probiotics Penaeus Monodon") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot
# boxplot log10
theme_set(theme_bw())
boxplot_log10 <- ggplot(data = table,
aes(y = log10,
x = variable,
color = Tissue)) +
geom_boxplot(aes(color = Tissue)) +
geom_point(aes(color = Tissue),
size = 1,
shape = 21,
position = position_jitterdodge()) +
facet_grid(Condition~Tissue) +
labs(x="",
y="Relative abundance (log10)",
title="Probiotics Penaeus Monodon") +
theme(legend.position = "none",
axis.text.x = element_text(angle = 90,
hjust = 1,
vjust = 0.5,
size = 6),
plot.title = element_text(face = "bold",
hjust = 0.5),
strip.text.x = element_text(size = 6))
boxplot_log10
